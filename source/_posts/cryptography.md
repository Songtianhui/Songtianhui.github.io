---
title: 问题求解笔记-密码算法
date: 2021-04-18 22:14:53
categories: problem-solving
mathjax: true
tags:
---

# 公钥加密系统

一个公钥加密系统中，每个参与者都拥有一把**公钥**$P$和**私钥**$S$，密钥需要保密，公钥可以公之于众。

$\mathcal{D}$表示允许信息的集合，要求公钥与密钥指定一种从$\mathcal{D}$到自身的一一对应的函数。
公钥函数$P()$和密钥函数$S()$都是$\mathcal{D}$的排列，互为反函数，即对任意的 $M \in \mathcal{D}$，有

$$M = S(P(M)) \text{ 且 } M = P(S(M))$$。

我们期望的就是除了密钥持有者以外，没有人能够高效地计算出 $S()$。

加密方法是加密的第一个“秘密”。但是加密方法不代表加密函数。

加密方法，再加上秘钥，才能唯一确定加密函数。

## 发送密文

- Bob取得Alice的公钥$P_A$。
- Bob计算出相应与$M$的密文$C=P_A(M)$，并把$C$发送给Alice。
- 当Alice收到密文$C$后，运用自己的密钥$S_A$恢复原始信息$M$。



## 数字签名

- Alice运用密钥$S_A$和等式$\sigma=S_A)M’$计算出信息$M’$的数字签名$\sigma$。
- Alice把消息/签名对$(M’,\sigma)$发给Bob。
- Bob收到$(M’,\sigma)$时，通过验证等式$M’=P_A(\sigma)$来证实消息的确是来自Alice。

任何人都可以把数字签名翻译出来，但只有密钥持有者可以生成数字签名。

用自己独有的“特性”：字迹、指纹、私章等，对自己发出的内容，如信函等，进行加工并送给接收方；接收方从中能够从加工信息中识别出发送方的独有特征并认定；

双发产生纠纷时，发送方提供自有特征证据、接收方提供解析出的“特征证据”，进行比对，否认或者不得不承认发送信息确实出自自身；

发送方的独有特征：私钥；

与加密的区别：提供签名方的不可抵赖 +  验证签名方的不可伪造。



# RSA加密系统

获得公私钥的过程：

1. 随机选择两个大素数 $p, q, p \neq q$。
2. 计算 $n = pq$。
3. 选取一个与 $\phi(n) = (p - 1)(q - 1)$ 互质的小奇数 $e$。
4. 对模 $\phi(n)$，计算 $e$ 的乘法逆元 $d$。（$e, \phi(n)$ 互质保证逆元存在且唯一，用exgcd）
5. $P = (e, n)$作**RSA公钥**。
6. $S = (e, n)$作**RSA私钥**。

原理在于：如果知道了 $n$ 不知道 $p,q$，由于大数的素数分解的复杂性很难获得 $\phi(n)$，所以即使知道 $e$ 也很难得到 $d$。

加密 $M \in \mathbb{Z}_n$：

$$P(M) = M^{e} \text{  mod } n$$

解密 $C \in \mathbb{Z}_n$：

$$S(C) = C^d \text{  mod } n$$

（可证 $M^{ed} \equiv M \quad (\text{mod } n )$）

